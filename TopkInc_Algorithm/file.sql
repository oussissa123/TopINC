SET search_path to food;
EXPLAIN (ANALYZE, BUFFERS, FORMAT json) SELECT * FROM foodinspection t0, foodinspection t1, foodinspection t2 WHERE (t0.results ilike '%fail%' or t0.violations ilike '%FOOD AND NON-FOOD CONTACT SURFACES%') and t0.license=t1.license  and t0.license=t2.license and  t1.results not ilike '%fail%'  and t1.inspection_type ilike '%canvass%' and t2.inspection_type ilike '%complaint%' and to_date(t0.inspection_date, 'MM/DD/YYYY') < to_date(t2.inspection_date, 'MM/DD/YYYY') and to_date(t1.inspection_date, 'MM/DD/YYYY') > to_date(t2.inspection_date, 'MM/DD/YYYY') AND t0.zip::bigint >= 60666  AND t2.zip::bigint > 60655  AND t1.zip::bigint > 60655 AND t0.vioset=7 AND t1.vioset=3 AND t2.vioset=7 LIMIT 100;
